---
description: Действия с абонентами. Большинство действий актуально для ручных биллингов.
---

# customer

```
Дополнительные параметры:
action - подкатегория запроса
```

## Подкатегории

### **add**

{% code overflow="wrap" %}
```markup
Описание: Добавление абонента
Необязательные параметры:
 fio - наименование абонента
 codeti - id абонента в биллинге
 is_potential - флаг - потенциальный абонент
 is_corporate - флаг - юридическое лицо
 billing_id - id биллинга (является обязательным, если это не потенциальный абонент)
 billing_customer_id - id абонента в биллинге (является обязательным, если это не потенциальный абонент)
```
{% endcode %}

### **abon\_hist**

```
Описание: Вывод операций с абонентом (финансовые и прочие)
Обязательные параметры:
 customer_id - ID абонента
```

### **change\_balance**

```
Описание: Изменение баланса (операция прихода/расхода)
Обязательные параметры:
 customer_id - ID абонента
 amount - Сумма
 comment - Заметки к операции
Необязательные параметры:
 employee_id - ID сотрудника
```

### **change\_billing**

```
Описание: Изменение биллинга
Обязательные параметры:
 customer_id - id абонента
 billing_id - id биллинга
Необязательные параметры:
 billing_user_id - id абонента в биллинге
```

### **change\_date\_connect**

```
Описание: Изменение даты подключения
Обязательные параметры:
 customer_id - ID абонента
 value - дата
```

### **delete**

```
Описание: Удаление абонента
Обязательные параметры:
 id - id абонента
```

### **edit**

```
Описание: Редактирование абонента
Обязательные параметры:
 id - id абонента
Необязательные параметры:
 account_number - номер лицевого счёта
 agreement_date - дата договора
 agreement_number - номер договора
 apartment_number - номер квартиры
 comment - заметки
 date_activity - дата активности в сети
 date_activity_inet - дата активности в интернете
 date_connect - дата подключения
 email - адрес электронной почты
 entrance - номер подъезда
 flag_corporate - флаг - юридическое лицо
 floor - этаж
 group_id - id группы
 house_id - id дома
 is_potential - флаг - потенциальный абонент
 login - логин
 manager_id - id сотрудника-менеджера
 name - наименование абонента
 parent_id - id родительского абонента (для дочернего абонента)
 phone0 - номер мобильного телефона
 phone1 - номер домашнего телефона
 phone2 - номер дополнительного телефона 1
 phone3 - номер дополнительного телефона 2
 phone4 - номер дополнительного телефона 3
```

### **get\_activity\_counter**

```
Описание: Получение счетчика активных абонентов
Обязательные параметры:
 type - тип счетчика (Возможные значения: net, internet, personal_area)
```

### **get\_abon\_id**

{% code overflow="wrap" %}
```
Описание: Получение ID абонента по входящим данным
Обязательные параметры:
 data_typer - тип данных, которые проверяем (возможные значения: account, billing_uid, codeti, dognumber, ip, login, mac, mail, phone)
 data_value - значение
Необязательные параметры:
 is_skip_old - флаг - не выполнять поиск среди бывших абонентов
```
{% endcode %}

### **get\_customer\_group**

```
Описание: Получение списка групп абонентов
Обязательные параметры:
 нет
Необязательные параметры:
 нет
```

### **get\_customers\_id**

{% code overflow="wrap" %}
```
Описание: Получение списка ID абонентов по входящим условиям
Обязательные параметры:
 нет
Необязательные параметры (но должно быть указано хотя бы одно условие):
 account_number - номер лицевого счёта
 address_unit_id - id адресной единицы
 appartment - номер квартиры
 balance_from - баланс (с)
 balance_to - баланс (до)
 billing_id - id номера биллинга
 billing_uuid - id абонента в биллинге
 date_connect_from - дата подключения (с)
 date_connect_to - дата подключения (до)
 dependence_device_id - id устройства, от которого зависят абоненты
 house_id - id дома
 is_corporate - флаг - юридическое лицо
 is_ex - флаг - бывшие абоненты
 manager_id - id менеджера (0 для поиска без менеджера)
 mark_id - id метки
 name - ФИО/название абонента
 state_id - id статуса
 tariff_id - id тарифа
 limit - максимальное количество записей, что вернуть в ответе
 is_like - флаг - использовать сравнение подстроки там где это возможно (а не полное совпадение)
```
{% endcode %}

### **get\_data**

```
Описание: Получение информации по абоненту
Обязательные параметры:
 customer_id - ID абонента
 либо
 account_number - номер лицевого счета абонента
 +
 billing_id - ID биллинга
```

### **get\_ip\_port\_device\_commutation**

{% code overflow="wrap" %}
```
Описание: Получение IP,MAC-адресов абонентов с привязкой к коммутаторам (в т.ч. для работы с DHCP)
```
{% endcode %}

### **get\_last\_ip**

```
Описание: Получение последнего используемого IP-адреса для абонентов
```

### **get\_mac\_history**

```
Описание: Получение истории изменения MAC-адресов по абоненту
Обязательные параметры:
 customer_id - id абонента
```

### **get\_max\_agreement\_number**

```
Описание: Получение максимального занятого номера договора (числового)
Необязательные параметры:
 billing_id - id биллинга абонентов, среди которых выполнять выборку
```

### **ip\_add**

```
Описание: Добавление IP-адреса
Обязательные параметры:
 customer_id - ID абонента
 value - IP
Необязательные параметры:
 mac - MAC абонента
```

### **ip\_delete**

{% code overflow="wrap" %}
```
Описание: Удаление IP-адреса
Обязательные параметры:
 customer_id - id абонента
 value - ip или "-1" для записей без IP-адреса (только с MAC-адресом) или "all" для всех адресов
```
{% endcode %}

### **ip\_subnet\_add**

```
Описание: Добавление подсети IP-адресов для абонента
Обязательные параметры:
 customer_id - id абонента
 ip - начальный ip-адрес
 subnet - маска подсети/VLSM (например: 24)
```

### **ip\_subnet\_delete**

```
Описание: Удаление подсети IP-адресов у абонента
Обязательные параметры:
 customer_id - id абонента
 ip - начальный ip-адрес
```

### **list\_tarif\_available**

```
Описание: Список тарифов, доступных абоненту для смены
Обязательные параметры:
 usercode - id абонента
```

### **mark\_add**

```
Описание: Добавление метки на абоненте
Обязательные параметры:
 customer_id - id абонента
 mark_id - id метки
```

### **mark\_delete**

```
Описание: Удаление метки с абонента
Обязательные параметры:
 customer_id - id абонента
 mark_id - id метки
```

### **merge**

```
Описание: Объединение абонентов
Обязательные параметры:
 dst_id - id основного абонента
 src_id - id вторичного абонента (информацию которого переносим к основному)
```

### **msg**

```
Описание: Вывод переписки с абонентом
Необязательные параметры (но должно быть что-то одно):
 customer_id - ID абонента
 date_add_from - дата сообщения (с)
 date_add_to - дата сообщения (до)
 employee_id - id сотрудника-автора сообщения
```

### **msg\_add**

```
Описание: Добавление сообщения от абонента
Обязательные параметры:
 customer_id - id абонента
 text - Текст сообщения
Необязательные параметры:
 is_arc - флаг - поместить сообщение в архив
```

### **msg\_add\_to\_customer**

```
Описание: Добавление сообщения от сотрудника к абоненту
Обязательные параметры:
 employee_id - id сотрудника
 customer_id - id абонента
 text - Текст сообщения
Необязательные параметры:
 is_arc - флаг - поместить сообщение в архив
```

### **pass\_change**

```
Описание: Смена пароля на вход в ЛК
Обязательные параметры:
 customer_id - ID абонента
 pass_new - новый пароль
Дополнительные параметры:
 pass_old - текущий пароль
```

### **service\_add**

```
Описание: Добавление доп.услуги
Обязательные параметры:
 customer_id - id абонента
 service_id - id доп.услуги
Необязательные параметры:
 price - индивидуальная стоимость
 comment - заметки
```

### **service\_remove**

```
Описание: Удаление доп.услуги
Обязательные параметры:
 customer_id - id абонента
 service_id - id доп.услуги
```

### **set\_mac\_by\_ip**

```
Описание: указание MAC-адреса для IP-адреса абонента
Обязательные параметры:
 ip - IP-адрес абонента (например: 192.168.0.1)
 mac - MAC-адрес абонента (например: 00:11:22:33:44:55)
```

### **state\_change**

```
Описание: изменение статуса работы у абонента
Обязательные параметры:
 customer_id - ID абонента
 state_id - ID статуса абонента (0 - стоп, 1 - пауза, 2 - активен)
```

### **tarif\_change**

```
Описание: смена тарифа абоненту
Обязательные параметры:
 customer_id - ID абонента
 tarif - ID нового тарифа
```

### **to\_ex**

```
Описание: перевод абонента в категорию "Бывшие абоненты"
Обязательные параметры:
 customer_id - ID абонента
```

### **to\_normal**

```
Описание: перевод абонента в в обычный статус (из "Бывших абонентов")
Обязательные параметры:
 customer_id - ID абонента
```
