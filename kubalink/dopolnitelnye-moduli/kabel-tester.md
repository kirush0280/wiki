# Кабель тестер

Предлагаемый модуль предназначен для автоматизации процесса тестирования кабелей с использованием кабельного тестера. Он поддерживает ряд известных моделей коммутаторов, что обеспечивает его широкую применимость в различных сетевых средах. Модуль периодически опрашивает длины кабелей, фиксируя полученные результаты в удобном формате.

Одной из ключевых особенностей данного модуля является система уведомлений, которая информирует ответственных сотрудников о любых изменениях в значениях длины кабелей. Это позволяет быстро реагировать на потенциальные проблемы, такие как износ кабелей или их неправильное соединение, что в свою очередь способствует повышению стабильности работы сети и предотвращению возможных сбоев.

Таким образом, модуль для периодического опроса длины кабелей не только упрощает процесс мониторинга, но и укрепляет надежность сетевой инфраструктуры, что является важным аспектом для организаций, стремящихся к эффективному управлению ресурсами.

Необходимые модули Perl:

```
Time::Local
Socket
FindBin
URI
URI::Escape
LWP::UserAgent
JSON
Data::Dumper
Net::Telnet
Net::SNMP
```

1. **Индивидуальный каталог:** Создайте отдельный каталог (вне публичного доступа) для установки модуля и логов. Убедитесь, что заданы права на запись.
2. **Конфигурация:** Переместите файлы из архива, переименуйте "usm\_cabletest.conf-example" в "usm\_cabletest.conf" и настройте его параметры.
3. **Проверка зависимостей:** Убедитесь, что все необходимые perl-пакеты установлены. В противном случае модуль не запустится.
4. **Запуск:** Включите модуль usm\_cabletest в вашем САП "Кубалинк" через раздел "Настройка - Модули". Запустите модуль командой `perl usm_cabletest.pl`. Убедитесь, что запуск прошёл без ошибок.
5. **Автоматизация:** Настройте запуск модуля в системном cron, учитывая, что на одно устройство требуется одна копия модуля. Оптимизируйте с помощью параметра `$delay`, чтобы избежать перегрузки.

При запуске модуль обрабатывает только одно устройство. В связи с этим в системный планировщик задач (cron) необходимо записать вызов соответствующего количества копий модуля, основываясь на количестве коммутаторов подходящих моделей в системе и желаемой частоте их опроса.

Каждая копия модуля может обработать одно устройство за 15 минут, что позволяет обработать до 15 устройств за этот период времени. Количество одновременно запускаемых копий модуля не ограничено, однако для предотвращения увеличенной нагрузки на коммутаторы и серверы, целесообразно использовать параметр `$delay`. Указав значение задержки, например, "20", можно задать случайное время запуска модулей в диапазоне от 1 до 20 секунд, тем самым распределяя нагрузку.

{% hint style="danger" %}
Опрос с использованием кабельного тестера представляет собой внутреннюю диагностическую операцию коммутатора. В процессе опроса коммутатор может временно включать и выключать порты для получения корректных данных. Следует учитывать, что частые опросы могут привести к зависанию оборудования.
{% endhint %}

Также необходимо помнить, что данные, полученные от кабельного тестера, могут иметь погрешность, достигающую нескольких метров.

Пример конфигурации cron для запуска трех копий:

```
* * * * *    root   perl /home/usm_cabletest/usm_cabletest.pl > /dev/null
* * * * *    root   perl /home/usm_cabletest/usm_cabletest.pl > /dev/null
* * * * *    root   perl /home/usm_cabletest/usm_cabletest.pl > /dev/null
```

В карточке устройства, опрошенного модулем **usm\_cabletest**, доступна ссылка для просмотра истории опроса данного устройства модулем, а также общей таблицы опроса устройств. В разделе таблицы портов карточки устройства отображаются последние известные длины кабелей на опрошенных портах.
